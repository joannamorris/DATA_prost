
---
title: "The P600 effect when singular gendered antecedents are co-indexed with (a) *himself* or *herself* (b) *themselves*"
author: "Joanna Morris"
date: "`r Sys.Date()`"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

This script, on the advice of reviewer 1, conducts an ANOVA examining the P600 PROST data with Referentiality and Gender as within-subject variables. Gender Identity status will be examined as a post-hoc variable. Analysis 1 examines the data for antecedents that are co-indexed with *himself* or *herself*, while Analysis 2 examines the  P600 effect when antecedents are co-indexed with *themselves*



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, error = FALSE, message = FALSE, fig.dim = c(6, 6))
library(knitr)
library(ggplot2)
library(ggrepel)
library(psych)
library(readr)
library(dplyr)
library(tidyr)
library(pander)
library(ggsci)
library(ez)
library(gridExtra)
```



## Define functions, set parameters and load

Define standard error of mean function

```{r echo=TRUE}
sem <- function(x) sd(x)/sqrt(length(x))
```

Before we begin, let's set some general parameters for `ggplot2`. We will set a general theme using the `theme_set()` function. We will use the 'classic' theme which gives us clean white background rather than the default grey with white grid lines. We will position the legend at the top of the graph rather than at the right side which is the default.

```{r theme}
theme_set(theme_classic()+
            theme(legend.position = "bottom")) 
```


```{r}
prost_2022_singular <- read_csv("prost_2022_singular_p600.csv")
prost_2022_plural <- read_csv("prost_2022_plural_p600.csv")
prost_2024_combined <- bind_rows(list(singular = prost_2022_singular, 
                                      plural = prost_2022_plural), .id = "Anaphor_Type")
```

Then we re-order factor levels for  *Referentiality*

```{r}
prost_2024_combined$Referentiality <- factor(prost_2024_combined$Referentiality, 
                                            levels=c('Referential',
                                                     'NonReferential'))
levels(prost_2024_combined$Referentiality)

```

## Analysis 

```{r echo=TRUE}

ezANOVA(data = prost_2024_combined
              , dv = diff_score
              , wid = SubjID
              , within = .(Referentiality, Gender_Status, Anaphor_Type)
              , type = 3
              , return_aov = F
              )
```

### Condition Means for Analysis 1


Significant Effects: **Referentiality; Referentiality x Anaphor Type; Referentiality X Gender Status X Anaphor Type**

```{r}

kable(singular_means1 <- prost_2024_combined |> 
  group_by(Referentiality) |>
  summarise(Mean = mean(diff_score), 
            SE = sem(diff_score), 
            SD = sd(diff_score), 
            Max = max(diff_score), 
            Min = min(diff_score)), digits = 2)

kable(singular_means1 <- prost_2024_combined |> 
  group_by(Referentiality, Anaphor_Type) |>
  summarise(Mean = mean(diff_score), 
            SE = sem(diff_score), 
            SD = sd(diff_score), 
            Max = max(diff_score), 
            Min = min(diff_score)), digits = 2)


kable(singular_means2 <- prost_2024_combined |> 
  group_by( Anaphor_Type, Referentiality,  Gender_Status) |>
  summarise(Mean = mean(diff_score), 
            SE = sem(diff_score), 
            SD = sd(diff_score), 
            Max = max(diff_score), 
            Min = min(diff_score)), digits = 2)

```

### Post-hoc tests 

Runs post-hoc tests for the 3-way ***"Gender Status x Referentiality"*** Interaction


"Some woman...himself" vs. "Mary...himself"  

```{r}
pander(t.test(diff_score ~ Referentiality
       , filter(prost_2022_singular, Gender_Status == "Gendered")
       , paired=TRUE))
```

"Someone...himself" vs. "The participant...himself" 

```{r}
pander(t.test(diff_score ~ Referentiality
       , filter(prost_2022_singular, Gender_Status == "NonGendered")
       , paired=TRUE))
```

"The participant...himself" vs. "Mary...himself"  

```{r}
pander(t.test(diff_score ~ Gender_Status
       , filter(prost_2022_singular, Referentiality == "Referential")
       , paired=TRUE))
```

"Someone...himself" vs. "Some woman...himself"  
 
```{r}
pander(t.test(diff_score ~ Gender_Status
       , filter(prost_2022_singular, Referentiality == "NonReferential" )
       , paired=TRUE))
```
"Some woman...themselves" vs. "Mary...themselves"  

```{r}
pander(t.test(diff_score ~ Referentiality
       , filter(prost_2022_plural, Gender_Status == "Gendered")
       , paired=TRUE))
```

"Someone...themselves" vs. "The participant...themselves" 

```{r}
pander(t.test(diff_score ~ Referentiality
       , filter(prost_2022_plural, Gender_Status == "NonGendered")
       , paired=TRUE))
```

"The participant...themselves" vs. "Mary...themselves"  

```{r}
pander(t.test(diff_score ~ Gender_Status
       , filter(prost_2022_plural, Referentiality == "Referential")
       , paired=TRUE))
```

"Someone...themselves" vs. "Some woman...themselves"  
 
```{r}
pander(t.test(diff_score ~ Gender_Status
       , filter(prost_2022_plural, Referentiality == "NonReferential" )
       , paired=TRUE))
```

##### Interaction Plots
&nbsp;

```{r}
summary_data_1 <- prost_2024_combined |>
  filter(Anaphor_Type == "singular") |>
  group_by(Gender_Status, Referentiality) |>
  summarise(mean = mean(diff_score), se = sem(diff_score))|> 
  mutate(lwr = mean - (1.96*se), upr = mean + (1.96*se))
summary_data_1$label = c("John...herself","some man...herself","the participant...herself", "someone...herself" )


plot1 <- ggplot(summary_data_1, aes(x = Referentiality, 
                         y = mean,
                         ymin = lwr,
                         ymax = upr,
                         fill = Gender_Status, 
                         group = Gender_Status,
                         label = label)) + 
  geom_bar(position=position_dodge(), stat="identity", colour = "black") + 
  geom_errorbar(width = .2, position = position_dodge(.9))  +
  geom_label_repel(show.legend = FALSE, cex = 1.5) +
  scale_fill_npg() + ylab("Voltage in microvolts") +
  theme(legend.text = element_text(size=10))+ 
  theme(legend.title = element_blank()) 


plot2 <- ggplot(summary_data_1, aes(x = Gender_Status, 
                         y = mean,
                         ymin = lwr,
                         ymax = upr,
                         fill = Referentiality, 
                         group = Referentiality,
                         label = label)) + 
  geom_bar(position=position_dodge(), stat="identity", colour = "black") + 
  geom_errorbar(width = .2, position = position_dodge(.9))  +
  geom_label_repel(show.legend = FALSE, cex = 1.5) +
  scale_fill_npg() + ylab("Voltage in microvolts")+
  theme(legend.text = element_text(size=10))+ 
  theme(legend.title = element_blank()) 

#plot1
#plot2

summary_data_2 <- prost_2024_combined |>
  filter(Anaphor_Type == "plural") |>
  group_by(Gender_Status, Referentiality) |>
  summarise(mean = mean(diff_score), se = sem(diff_score))|> 
  mutate(lwr = mean - (1.96*se), upr = mean + (1.96*se))
summary_data_2$label = c("John...themselves","some man...themselves","the participant...themselves", "someone...themselves" )


plot3 <- ggplot(summary_data_2, aes(x = Referentiality, 
                         y = mean,
                         ymin = lwr,
                         ymax = upr,
                         fill = Gender_Status, 
                         group = Gender_Status,
                         label = label)) + 
  geom_bar(position=position_dodge(), stat="identity", colour = "black") + 
  geom_errorbar(width = .2, position = position_dodge(.9))  +
  geom_label_repel(show.legend = FALSE, cex = 1.5) +
  scale_fill_npg() + ylab("Voltage in microvolts") +
  theme(legend.text = element_text(size=10))+ 
  theme(legend.title = element_blank()) 


plot4 <- ggplot(summary_data_2, aes(x = Gender_Status, 
                         y = mean,
                         ymin = lwr,
                         ymax = upr,
                         fill = Referentiality, 
                         group = Referentiality,
                         label = label)) + 
  geom_bar(position=position_dodge(), stat="identity", colour = "black") + 
  geom_errorbar(width = .2, position = position_dodge(.9))  +
  geom_label_repel(show.legend = FALSE, cex = 1.5) +
  scale_fill_npg() + ylab("Voltage in microvolts")+
  theme(legend.text = element_text(size=10))+ 
  theme(legend.title = element_blank()) 

grid.arrange(plot1, plot3, plot2, plot4, ncol=2, 
             top = "Gender Status by Referentiality Interaction")
```




